<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#1a1a2e"/>
      <stop offset="100%" stop-color="#16213e"/>
    </linearGradient>
    <linearGradient id="taGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#0f3460"/>
      <stop offset="100%" stop-color="#533483"/>
    </linearGradient>
    <linearGradient id="pxGrad1" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#e94560"/>
      <stop offset="100%" stop-color="#c23152"/>
    </linearGradient>
    <linearGradient id="pxGrad8" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#0ea5e9"/>
      <stop offset="100%" stop-color="#0369a1"/>
    </linearGradient>
    <linearGradient id="pxGrad24" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#22c55e"/>
      <stop offset="100%" stop-color="#15803d"/>
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="520" rx="12" fill="#0d1117"/>

  <!-- Title -->
  <text x="450" y="40" text-anchor="middle" fill="#e6edf3" font-size="20" font-weight="700">Pixel Buffer Memory Layout</text>

  <!-- === 1bipp Section === -->
  <g transform="translate(30, 70)">
    <rect width="260" height="170" rx="8" fill="url(#headerGrad)" filter="url(#shadow)"/>
    <text x="130" y="25" text-anchor="middle" fill="#e94560" font-size="14" font-weight="700">1 bit per pixel</text>
    <text x="130" y="42" text-anchor="middle" fill="#8b949e" font-size="10">Binary mask — 8 pixels per byte</text>

    <!-- Byte box -->
    <rect x="15" y="55" width="230" height="40" rx="4" fill="#161b22" stroke="#30363d" stroke-width="1"/>
    <text x="130" y="72" text-anchor="middle" fill="#8b949e" font-size="9">Byte 0</text>

    <!-- Individual bits -->
    <g transform="translate(19, 78)">
      <rect width="26" height="14" rx="2" fill="url(#pxGrad1)"/><text x="13" y="10.5" text-anchor="middle" fill="#fff" font-size="8" font-weight="600">1</text>
      <rect x="28" width="26" height="14" rx="2" fill="#21262d" stroke="#30363d" stroke-width="0.5"/><text x="41" y="10.5" text-anchor="middle" fill="#8b949e" font-size="8">0</text>
      <rect x="56" width="26" height="14" rx="2" fill="url(#pxGrad1)"/><text x="69" y="10.5" text-anchor="middle" fill="#fff" font-size="8" font-weight="600">1</text>
      <rect x="84" width="26" height="14" rx="2" fill="url(#pxGrad1)"/><text x="97" y="10.5" text-anchor="middle" fill="#fff" font-size="8" font-weight="600">1</text>
      <rect x="112" width="26" height="14" rx="2" fill="#21262d" stroke="#30363d" stroke-width="0.5"/><text x="125" y="10.5" text-anchor="middle" fill="#8b949e" font-size="8">0</text>
      <rect x="140" width="26" height="14" rx="2" fill="#21262d" stroke="#30363d" stroke-width="0.5"/><text x="153" y="10.5" text-anchor="middle" fill="#8b949e" font-size="8">0</text>
      <rect x="168" width="26" height="14" rx="2" fill="url(#pxGrad1)"/><text x="181" y="10.5" text-anchor="middle" fill="#fff" font-size="8" font-weight="600">1</text>
      <rect x="196" width="26" height="14" rx="2" fill="#21262d" stroke="#30363d" stroke-width="0.5"/><text x="209" y="10.5" text-anchor="middle" fill="#8b949e" font-size="8">0</text>
    </g>
    <text x="130" y="108" text-anchor="middle" fill="#8b949e" font-size="8">bit 7 ←────────────────────→ bit 0</text>

    <!-- Formula -->
    <rect x="15" y="118" width="230" height="40" rx="4" fill="#161b22" stroke="#30363d" stroke-width="1"/>
    <text x="130" y="134" text-anchor="middle" fill="#c9d1d9" font-size="9" font-family="monospace">byte_index = pixel_index >> 3</text>
    <text x="130" y="148" text-anchor="middle" fill="#c9d1d9" font-size="9" font-family="monospace">bit  = pixel_index &amp; 0b111</text>
  </g>

  <!-- === 8bipp Section === -->
  <g transform="translate(320, 70)">
    <rect width="260" height="170" rx="8" fill="url(#headerGrad)" filter="url(#shadow)"/>
    <text x="130" y="25" text-anchor="middle" fill="#0ea5e9" font-size="14" font-weight="700">8 bits per pixel</text>
    <text x="130" y="42" text-anchor="middle" fill="#8b949e" font-size="10">Greyscale — 1 byte per pixel</text>

    <!-- Pixel bytes -->
    <g transform="translate(15, 55)">
      <rect width="50" height="40" rx="4" fill="url(#pxGrad8)" opacity="0.3"/><text x="25" y="24" text-anchor="middle" fill="#7dd3fc" font-size="10" font-weight="600">0</text>
      <rect x="54" width="50" height="40" rx="4" fill="url(#pxGrad8)" opacity="0.5"/><text x="79" y="24" text-anchor="middle" fill="#7dd3fc" font-size="10" font-weight="600">64</text>
      <rect x="108" width="50" height="40" rx="4" fill="url(#pxGrad8)" opacity="0.7"/><text x="133" y="24" text-anchor="middle" fill="#7dd3fc" font-size="10" font-weight="600">128</text>
      <rect x="162" width="50" height="40" rx="4" fill="url(#pxGrad8)"/><text x="187" y="24" text-anchor="middle" fill="#fff" font-size="10" font-weight="600">255</text>
    </g>
    <text x="130" y="112" text-anchor="middle" fill="#8b949e" font-size="8">px[0]     px[1]     px[2]     px[3]</text>

    <!-- Formula -->
    <rect x="15" y="118" width="230" height="40" rx="4" fill="#161b22" stroke="#30363d" stroke-width="1"/>
    <text x="130" y="134" text-anchor="middle" fill="#c9d1d9" font-size="9" font-family="monospace">byte_index = y * width + x</text>
    <text x="130" y="148" text-anchor="middle" fill="#c9d1d9" font-size="9" font-family="monospace">ta[byte_index] = greyscale</text>
  </g>

  <!-- === 24bipp Section === -->
  <g transform="translate(610, 70)">
    <rect width="260" height="170" rx="8" fill="url(#headerGrad)" filter="url(#shadow)"/>
    <text x="130" y="25" text-anchor="middle" fill="#22c55e" font-size="14" font-weight="700">24 bits per pixel</text>
    <text x="130" y="42" text-anchor="middle" fill="#8b949e" font-size="10">RGB — 3 bytes per pixel</text>

    <!-- One pixel = 3 bytes -->
    <g transform="translate(35, 58)">
      <rect width="60" height="36" rx="4" fill="#ef4444"/><text x="30" y="22" text-anchor="middle" fill="#fff" font-size="11" font-weight="600">R</text>
      <rect x="64" width="60" height="36" rx="4" fill="#22c55e"/><text x="94" y="22" text-anchor="middle" fill="#fff" font-size="11" font-weight="600">G</text>
      <rect x="128" width="60" height="36" rx="4" fill="#3b82f6"/><text x="158" y="22" text-anchor="middle" fill="#fff" font-size="11" font-weight="600">B</text>
    </g>
    <text x="130" y="112" text-anchor="middle" fill="#8b949e" font-size="8">← one pixel (3 bytes) →</text>

    <!-- Formula -->
    <rect x="15" y="118" width="230" height="40" rx="4" fill="#161b22" stroke="#30363d" stroke-width="1"/>
    <text x="130" y="134" text-anchor="middle" fill="#c9d1d9" font-size="9" font-family="monospace">byte = (y * width + x) * 3</text>
    <text x="130" y="148" text-anchor="middle" fill="#c9d1d9" font-size="9" font-family="monospace">ta[byte]=R, [byte+1]=G, [byte+2]=B</text>
  </g>

  <!-- === Full buffer diagram === -->
  <g transform="translate(30, 270)">
    <rect width="840" height="230" rx="8" fill="url(#headerGrad)" filter="url(#shadow)"/>
    <text x="420" y="25" text-anchor="middle" fill="#e6edf3" font-size="14" font-weight="700">Uint8Array — Flat Row-Major Storage</text>

    <!-- Grid representing buffer -->
    <g transform="translate(40, 45)">
      <!-- Row labels -->
      <text x="-8" y="20" text-anchor="end" fill="#8b949e" font-size="9">y=0</text>
      <text x="-8" y="55" text-anchor="end" fill="#8b949e" font-size="9">y=1</text>
      <text x="-8" y="90" text-anchor="end" fill="#8b949e" font-size="9">y=2</text>
      <text x="-8" y="125" text-anchor="end" fill="#8b949e" font-size="9">y=3</text>

      <!-- Column labels -->
      <text x="22" y="-4" text-anchor="middle" fill="#8b949e" font-size="8">x=0</text>
      <text x="62" y="-4" text-anchor="middle" fill="#8b949e" font-size="8">x=1</text>
      <text x="102" y="-4" text-anchor="middle" fill="#8b949e" font-size="8">x=2</text>
      <text x="142" y="-4" text-anchor="middle" fill="#8b949e" font-size="8">x=3</text>
      <text x="182" y="-4" text-anchor="middle" fill="#8b949e" font-size="8">x=4</text>
      <text x="222" y="-4" text-anchor="middle" fill="#8b949e" font-size="8">x=5</text>
      <text x="262" y="-4" text-anchor="middle" fill="#8b949e" font-size="8">x=6</text>
      <text x="302" y="-4" text-anchor="middle" fill="#8b949e" font-size="8">x=7</text>

      <!-- Grid cells row 0 -->
      <rect x="2" y="6" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="20" y="23" text-anchor="middle" fill="#7dd3fc" font-size="8">[0]</text>
      <rect x="42" y="6" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="60" y="23" text-anchor="middle" fill="#7dd3fc" font-size="8">[1]</text>
      <rect x="82" y="6" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="100" y="23" text-anchor="middle" fill="#7dd3fc" font-size="8">[2]</text>
      <rect x="122" y="6" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="140" y="23" text-anchor="middle" fill="#7dd3fc" font-size="8">[3]</text>
      <rect x="162" y="6" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="180" y="23" text-anchor="middle" fill="#7dd3fc" font-size="8">[4]</text>
      <rect x="202" y="6" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="220" y="23" text-anchor="middle" fill="#7dd3fc" font-size="8">[5]</text>
      <rect x="242" y="6" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="260" y="23" text-anchor="middle" fill="#7dd3fc" font-size="8">[6]</text>
      <rect x="282" y="6" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="300" y="23" text-anchor="middle" fill="#7dd3fc" font-size="8">[7]</text>

      <!-- Grid cells row 1 -->
      <rect x="2" y="40" width="36" height="26" rx="3" fill="#1c3d42"/><text x="20" y="57" text-anchor="middle" fill="#5eead4" font-size="8">[8]</text>
      <rect x="42" y="40" width="36" height="26" rx="3" fill="#1c3d42"/><text x="60" y="57" text-anchor="middle" fill="#5eead4" font-size="8">[9]</text>
      <rect x="82" y="40" width="36" height="26" rx="3" fill="#1c3d42"/><text x="100" y="57" text-anchor="middle" fill="#5eead4" font-size="8">[10]</text>
      <rect x="122" y="40" width="36" height="26" rx="3" fill="#1c3d42"/><text x="140" y="57" text-anchor="middle" fill="#5eead4" font-size="8">[11]</text>
      <rect x="162" y="40" width="36" height="26" rx="3" fill="#1c3d42"/><text x="180" y="57" text-anchor="middle" fill="#5eead4" font-size="8">[12]</text>
      <rect x="202" y="40" width="36" height="26" rx="3" fill="#1c3d42"/><text x="220" y="57" text-anchor="middle" fill="#5eead4" font-size="8">[13]</text>
      <rect x="242" y="40" width="36" height="26" rx="3" fill="#1c3d42"/><text x="260" y="57" text-anchor="middle" fill="#5eead4" font-size="8">[14]</text>
      <rect x="282" y="40" width="36" height="26" rx="3" fill="#1c3d42"/><text x="300" y="57" text-anchor="middle" fill="#5eead4" font-size="8">[15]</text>

      <!-- Row 2 -->
      <rect x="2" y="74" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="20" y="91" text-anchor="middle" fill="#7dd3fc" font-size="8">[16]</text>
      <rect x="42" y="74" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="60" y="91" text-anchor="middle" fill="#7dd3fc" font-size="8">[17]</text>
      <rect x="82" y="74" width="36" height="26" rx="3" fill="#e94560" opacity="0.8"/><text x="100" y="91" text-anchor="middle" fill="#fff" font-size="8" font-weight="700">[18]</text>
      <rect x="122" y="74" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="140" y="91" text-anchor="middle" fill="#7dd3fc" font-size="8">[19]</text>
      <rect x="162" y="74" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="180" y="91" text-anchor="middle" fill="#7dd3fc" font-size="8">[20]</text>
      <rect x="202" y="74" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="220" y="91" text-anchor="middle" fill="#7dd3fc" font-size="8">[21]</text>
      <rect x="242" y="74" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="260" y="91" text-anchor="middle" fill="#7dd3fc" font-size="8">[22]</text>
      <rect x="282" y="74" width="36" height="26" rx="3" fill="#1a3a5c"/><text x="300" y="91" text-anchor="middle" fill="#7dd3fc" font-size="8">[23]</text>

      <!-- Row 3 -->
      <rect x="2" y="108" width="36" height="26" rx="3" fill="#1c3d42"/><text x="20" y="125" text-anchor="middle" fill="#5eead4" font-size="8">[24]</text>
      <rect x="42" y="108" width="36" height="26" rx="3" fill="#1c3d42"/><text x="60" y="125" text-anchor="middle" fill="#5eead4" font-size="8">[25]</text>
      <rect x="82" y="108" width="36" height="26" rx="3" fill="#1c3d42"/><text x="100" y="125" text-anchor="middle" fill="#5eead4" font-size="8">[26]</text>
      <rect x="122" y="108" width="36" height="26" rx="3" fill="#1c3d42"/><text x="140" y="125" text-anchor="middle" fill="#5eead4" font-size="8">[27]</text>
      <rect x="162" y="108" width="36" height="26" rx="3" fill="#1c3d42"/><text x="180" y="125" text-anchor="middle" fill="#5eead4" font-size="8">[28]</text>
      <rect x="202" y="108" width="36" height="26" rx="3" fill="#1c3d42"/><text x="220" y="125" text-anchor="middle" fill="#5eead4" font-size="8">[29]</text>
      <rect x="242" y="108" width="36" height="26" rx="3" fill="#1c3d42"/><text x="260" y="125" text-anchor="middle" fill="#5eead4" font-size="8">[30]</text>
      <rect x="282" y="108" width="36" height="26" rx="3" fill="#1c3d42"/><text x="300" y="125" text-anchor="middle" fill="#5eead4" font-size="8">[31]</text>

      <!-- Highlight annotation -->
      <line x1="118" y1="87" x2="380" y2="70" stroke="#e94560" stroke-width="1.5" stroke-dasharray="4,3"/>
      <rect x="380" y="55" width="200" height="38" rx="4" fill="#21262d" stroke="#e94560" stroke-width="1"/>
      <text x="480" y="72" text-anchor="middle" fill="#e94560" font-size="10" font-weight="600">index = y × width + x</text>
      <text x="480" y="85" text-anchor="middle" fill="#8b949e" font-size="9">index = 2 × 8 + 2 = 18</text>
    </g>

    <!-- Key properties box -->
    <g transform="translate(470, 140)">
      <rect width="340" height="75" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
      <text x="170" y="18" text-anchor="middle" fill="#e6edf3" font-size="11" font-weight="600">Key Properties</text>
      <text x="15" y="36" fill="#7dd3fc" font-size="9" font-family="monospace">.ta</text><text x="55" y="36" fill="#8b949e" font-size="9">→ Uint8Array (raw bytes)</text>
      <text x="15" y="50" fill="#7dd3fc" font-size="9" font-family="monospace">.size</text><text x="55" y="50" fill="#8b949e" font-size="9">→ Int16Array [width, height]</text>
      <text x="15" y="64" fill="#7dd3fc" font-size="9" font-family="monospace">.bipp</text><text x="55" y="64" fill="#8b949e" font-size="9">→ bits per pixel (1, 8, 24, 32)</text>
      <text x="175" y="36" fill="#7dd3fc" font-size="9" font-family="monospace">.bypp</text><text x="220" y="36" fill="#8b949e" font-size="9">→ bytes per pixel</text>
      <text x="175" y="50" fill="#7dd3fc" font-size="9" font-family="monospace">.bypr</text><text x="220" y="50" fill="#8b949e" font-size="9">→ bytes per row</text>
      <text x="175" y="64" fill="#7dd3fc" font-size="9" font-family="monospace">.num_px</text><text x="225" y="64" fill="#8b949e" font-size="9">→ total pixel count</text>
    </g>
  </g>
</svg>
